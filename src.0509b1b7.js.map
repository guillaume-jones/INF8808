{"version":3,"sources":["../node_modules/regenerator-runtime/runtime.js","../node_modules/point-in-polygon/flat.js","../node_modules/point-in-polygon/nested.js","../node_modules/point-in-polygon/index.js","scripts/geography.js","scripts/preprocess.js","scripts/mapViz.js","scripts/yearButton.js","scripts/clickHandlers.js","scripts/lineChart.js","scripts/areaChart.js","scripts/barChartViz.js","index.js"],"names":["getMontrealData","d3","json","getBikePaths","determineNeighborhood","lon","lat","montreal","returnName","forEach","feature","geometry","coordinates","properties","NOM","getProjection","geoMercator","center","scale","getPath","projection","geoPath","convertCoordinatesToXY","longitude","latitude","projected","x","y","sum","a","key","map","reduce","b","c","isNaN","groupSum","key2","getCounterData","years","counterData","Promise","all","year","csv","getLocationData","createDataset","locations","counters","dataset","acceptedCounters","Object","keys","filter","name","counter","find","t","includes","ID","Nom","Longitude","Latitude","counts","timestep","date","undefined","time","entries","value","dateTime","split","length","count","parseInt","push","createMapData","mapData","yearData","neighborhood","createLineChartData","lineChartData","averageDayCounts","newCounts","values","data","i","v","index","totalCounters","Math","round","createAreaChartData","areaChartData","averageTimeCounts","createBarChartData","barChartData","allCounts","counterSum","average","generateMapGroups","width","height","select","attr","append","parentNode","drawMapBackground","path","selectAll","enter","drawBikePaths","radiusScale","maxCounts","max","scaleLinear","domain","range","drawCircles","callback","remove","d","on","drawDropdown","text","dropDownClickHandler","property","console","log","circleClickHandler","generateXScale","days","generateXTimescale","scaleTime","Date","nice","generateYScale","addLabels","g","addAxes","yScale","call","axisBottom","ticks","axisLeft","drawLineChart","averageData","group","xScale","datum","line","drawAreaChart","area","y0","y1","appendAxes","appendGraphLabels","setCanvasSize","positionLabels","updateXSubgroupScale","subGroupBars","bandwidth","drawXAxis","tickFormat","drawYAxis","updateGroupXScale","Average","updateYScale","m","createGroups","drawBars","xSubgroup","margin","top","right","bottom","left","bounds","svgSize","graphSize","scaleBand","padding","xSubgroupScale","setSizing","node","getBoundingClientRect","buildBarChart","redrawVizForCounter","redrawVizForYear","areaSize","lineSize","mapsize","bikePaths","locationData"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACZA;;;;;;;;AAEA;;;;SAIsBA;;;AAItB;;;;;;;6EAJO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACQC,EAAE,CAACC,IAAH,CAAQ,eAAR,CADR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;SAQeC;;;AAItB;;;;;;;;;;;;0EAJO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACQF,EAAE,CAACC,IAAH,CAAQ,yBAAR,CADR;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAaA,SAASE,qBAAT,CAA+BC,GAA/B,EAAoCC,GAApC,EAAyCC,QAAzC,EAAmD;AACxD,MAAIC,UAAU,GAAG,EAAjB;AAEAD,EAAAA,QAAQ,CAACE,OAAT,CAAiB,UAACC,OAAD,EAAa;AAC5B,QAAI,6BAAe,CAACL,GAAD,EAAMC,GAAN,CAAf,EAA2BI,OAAO,CAACC,QAAR,CAAiBC,WAAjB,CAA6B,CAA7B,EAAgC,CAAhC,CAA3B,CAAJ,EAAoE;AAClEJ,MAAAA,UAAU,GAAGE,OAAO,CAACG,UAAR,CAAmBC,GAAhC;AACD;AACF,GAJD;A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","file":"src.0509b1b7.js","sourceRoot":"..\\src","sourcesContent":["/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = GeneratorFunctionPrototype;\n  define(Gp, \"constructor\", GeneratorFunctionPrototype);\n  define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction);\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  });\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  define(Gp, iteratorSymbol, function() {\n    return this;\n  });\n\n  define(Gp, \"toString\", function() {\n    return \"[object Generator]\";\n  });\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, in modern engines\n  // we can explicitly access globalThis. In older engines we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","module.exports = function pointInPolygonFlat (point, vs, start, end) {\n    var x = point[0], y = point[1];\n    var inside = false;\n    if (start === undefined) start = 0;\n    if (end === undefined) end = vs.length;\n    var len = (end-start)/2;\n    for (var i = 0, j = len - 1; i < len; j = i++) {\n        var xi = vs[start+i*2+0], yi = vs[start+i*2+1];\n        var xj = vs[start+j*2+0], yj = vs[start+j*2+1];\n        var intersect = ((yi > y) !== (yj > y))\n            && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n        if (intersect) inside = !inside;\n    }\n    return inside;\n};\n","// ray-casting algorithm based on\n// https://wrf.ecse.rpi.edu/Research/Short_Notes/pnpoly.html\n\nmodule.exports = function pointInPolygonNested (point, vs, start, end) {\n    var x = point[0], y = point[1];\n    var inside = false;\n    if (start === undefined) start = 0;\n    if (end === undefined) end = vs.length;\n    var len = end - start;\n    for (var i = 0, j = len - 1; i < len; j = i++) {\n        var xi = vs[i+start][0], yi = vs[i+start][1];\n        var xj = vs[j+start][0], yj = vs[j+start][1];\n        var intersect = ((yi > y) !== (yj > y))\n            && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n        if (intersect) inside = !inside;\n    }\n    return inside;\n};\n","var pointInPolygonFlat = require('./flat.js')\nvar pointInPolygonNested = require('./nested.js')\n\nmodule.exports = function pointInPolygon (point, vs, start, end) {\n    if (vs.length > 0 && Array.isArray(vs[0])) {\n        return pointInPolygonNested(point, vs, start, end);\n    } else {\n        return pointInPolygonFlat(point, vs, start, end);\n    }\n}\nmodule.exports.nested = pointInPolygonNested\nmodule.exports.flat = pointInPolygonFlat\n","import pointInPolygon from 'point-in-polygon';\r\n\r\n/** Gets the Montreal geographical data\r\n *\r\n * @returns {object[]} Montreal GEOJSON\r\n */\r\nexport async function getMontrealData() {\r\n  return await d3.json('montreal.json');\r\n}\r\n\r\n/** Gets the Montreal geographical data\r\n *\r\n * @returns {object[]} Montreal's bike path GEOJSON\r\n */\r\nexport async function getBikePaths() {\r\n  return await d3.json('reseau_cyclable.geojson');\r\n}\r\n\r\n/**\r\n * Determines the neighborhood based on coordinates\r\n *\r\n * @param lon Longitude of point (float)\r\n * @param lat Latitude of point (float)\r\n * @param montreal Pre-loaded JSON of Montreal data\r\n *\r\n * @returns {string} Neighborhood of point or empty if not found\r\n */\r\nexport function determineNeighborhood(lon, lat, montreal) {\r\n  let returnName = '';\r\n\r\n  montreal.forEach((feature) => {\r\n    if (pointInPolygon([lon, lat], feature.geometry.coordinates[0][0])) {\r\n      returnName = feature.properties.NOM;\r\n    }\r\n  });\r\n\r\n  return returnName;\r\n}\r\n\r\n/** Gets the map projection function\r\n *\r\n * @returns Projection function in Mercator for Montreal\r\n */\r\nexport function getProjection() {\r\n  return d3.geoMercator().center([-73.708879, 45.579611]).scale(70000);\r\n}\r\n\r\n/** Gets the path function\r\n *\r\n * @param projection Projection in Mercator for Montreal\r\n *\r\n * @returns Path function for Montreal\r\n */\r\nexport function getPath(projection) {\r\n  return d3.geoPath().projection(projection);\r\n}\r\n\r\n/** Gets the XY positions on the map viz for a given set of coordinates\r\n * @param {number} longitude Longitude to convert\r\n * @param {number} latitude Latitude to convert\r\n * @param projection Projection in Mercator for Montreal\r\n *\r\n * @returns {x: number, y: number}\r\n */\r\nexport function convertCoordinatesToXY(longitude, latitude, projection) {\r\n  const projected = projection([longitude, latitude]);\r\n  return {\r\n    x: projected[0],\r\n    y: projected[1],\r\n  };\r\n}\r\n","import { convertCoordinatesToXY, determineNeighborhood } from './geography';\r\n\r\nfunction sum(a, key = '') {\r\n  if (key) {\r\n    a = a.map((a) => a[key]);\r\n  }\r\n  return a.reduce((b, c) => b + (isNaN(c) ? 0 : c), 0);\r\n}\r\n\r\nfunction groupSum(a, key, key2) {\r\n  return a.reduce((b, c) => {\r\n    b[c[key]] = (b[c[key]] || 0) + (isNaN(c[key2]) ? 0 : c[key2]);\r\n    return b;\r\n  }, {});\r\n}\r\n\r\n/** Load counter CSVs\r\n *\r\n * @param {number[]} years Array of years to load\r\n *\r\n * @returns {object[]} Array of data by year\r\n */\r\nexport async function getCounterData(years) {\r\n  const counterData = {};\r\n  // Required due to asynchronous loop\r\n  await Promise.all(\r\n    years.map(async (year) => {\r\n      counterData[year] = await d3.csv('comptage_velo_' + year + '.csv');\r\n    }),\r\n  );\r\n\r\n  return counterData;\r\n}\r\n\r\n/** Load location CSV\r\n *\r\n * @returns {object} Location data\r\n */\r\nexport async function getLocationData() {\r\n  return await d3.csv('localisation_des_compteurs_velo.csv');\r\n}\r\n\r\n/** Convert location and counter data into usable dataset\r\n *\r\n * Filters out partial data\r\n * Harmonizes IDs and names\r\n * Organizes by year, counter name, date and time\r\n *\r\n * @param {object} locations Location data from CSV\r\n * @param {object[]} counters Counter data from CSV\r\n * @param {object} years Years of data loaded into counters\r\n *\r\n * @returns {object[]} The filtered and combined dataset\r\n */\r\nexport function createDataset(locations, counters, years) {\r\n  const dataset = {};\r\n\r\n  years.forEach((year) => {\r\n    const counterData = counters[year];\r\n    dataset[year] = {};\r\n\r\n    // Keeps only data columns\r\n    const acceptedCounters = Object.keys(counterData[0]).filter((name) => {\r\n      return name !== 'Date' && name !== '';\r\n    });\r\n\r\n    // Gets relevant data for each counter from location dataset\r\n    acceptedCounters.forEach((name) => {\r\n      const counter = locations.find((t) => {\r\n        if (name.includes('compteur')) {\r\n          // Finds via ID, for 2019-2021 datasets\r\n          return name.includes(t.ID);\r\n        } else {\r\n          // Finds via name, for 2009-2018 datasets\r\n          return t.Nom === name;\r\n        }\r\n      });\r\n\r\n      dataset[year][counter.Nom] = {\r\n        name: counter.Nom,\r\n        longitude: counter.Longitude,\r\n        latitude: counter.Latitude,\r\n        counts: [],\r\n      };\r\n    });\r\n\r\n    // Iterates through counterData to add counts to each counter\r\n    counterData.forEach((timestep) => {\r\n      let date = undefined;\r\n      let time = '00:00';\r\n\r\n      Object.entries(timestep)\r\n        .map(([key, value]) => {\r\n          if (key === 'Date') {\r\n            const dateTime = value.split(' ');\r\n            date = dateTime[0];\r\n            // Gets time as well for datasets after 2018\r\n            if (dateTime.length > 1) {\r\n              time = dateTime[1];\r\n            }\r\n          }\r\n          return [key, value];\r\n        })\r\n        .filter(([name]) => acceptedCounters.includes(name))\r\n        .forEach(([name, count]) => {\r\n          if (parseInt(year) > 2018) {\r\n            name = locations.find((t) => name.includes(t.ID)).Nom;\r\n          }\r\n          dataset[year][name].counts.push({\r\n            date: date,\r\n            time: time,\r\n            count: parseInt(count),\r\n          });\r\n        });\r\n    });\r\n  });\r\n\r\n  return dataset;\r\n}\r\n\r\n/** Generates data in format for map\r\n *\r\n * @param {object} dataset Dataset created by createDataset\r\n * @param montreal Pre-loaded JSON of Montreal data\r\n * @param projection Projection used for the map\r\n *\r\n * @returns {object} Data for Area chart\r\n */\r\nexport function createMapData(dataset, montreal, projection) {\r\n  const mapData = {};\r\n\r\n  Object.entries(dataset).forEach(([year, yearData]) => {\r\n    mapData[year] = Object.entries(yearData).map(([counter, counterData]) => {\r\n      return {\r\n        name: counter,\r\n        neighborhood: determineNeighborhood(\r\n          counterData.longitude,\r\n          counterData.latitude,\r\n          montreal,\r\n        ),\r\n        counts: sum(counterData.counts, 'count'),\r\n        ...convertCoordinatesToXY(\r\n          counterData.longitude,\r\n          counterData.latitude,\r\n          projection,\r\n        ),\r\n      };\r\n    });\r\n  });\r\n\r\n  return mapData;\r\n}\r\n\r\n/** Generates data in format for line chart\r\n *\r\n * @param {object} dataset Dataset created by createDataset\r\n * @param montreal Pre-loaded JSON of Montreal data\r\n */\r\nexport function createLineChartData(dataset, montreal) {\r\n  const lineChartData = {};\r\n\r\n  Object.entries(dataset).forEach(([year, yearData]) => {\r\n    lineChartData[year] = {};\r\n    let averageDayCounts;\r\n\r\n    // Sums counts across each day for each counter\r\n    // Also adds neighborhood\r\n    Object.entries(yearData).forEach(([counter, counterData]) => {\r\n      let newCounts = [];\r\n\r\n      // Years 2019-2021 need to group the data by day\r\n      if (counterData.counts.length > 366) {\r\n        newCounts = Object.values(\r\n          groupSum(counterData.counts, 'date', 'count'),\r\n        );\r\n      } else {\r\n        newCounts = counterData.counts.map((data) => data.count);\r\n      }\r\n\r\n      // Save this counter's data to averageDayCounts\r\n      if (!averageDayCounts) {\r\n        averageDayCounts = newCounts;\r\n      } else {\r\n        newCounts.map((count, i) => {\r\n          averageDayCounts[i] += count;\r\n        });\r\n      }\r\n\r\n      lineChartData[year][counter] = {\r\n        name: counter,\r\n        neighborhood: determineNeighborhood(\r\n          counterData.longitude,\r\n          counterData.latitude,\r\n          montreal,\r\n        ),\r\n        counts: newCounts.map((v, i) => {\r\n          return {\r\n            index: i,\r\n            value: v,\r\n          };\r\n        }),\r\n      };\r\n    });\r\n\r\n    const totalCounters = Object.keys(yearData).length;\r\n\r\n    lineChartData[year]['Average'] = {\r\n      name: 'All',\r\n      neighborhood: '',\r\n      counts: averageDayCounts.map((counts, i) => {\r\n        return { index: i, value: Math.round(counts / totalCounters) };\r\n      }),\r\n    };\r\n  });\r\n\r\n  return lineChartData;\r\n}\r\n\r\n/** Generates data in format for area chart\r\n *\r\n * @param {object} dataset Dataset created by createDataset\r\n *\r\n * @returns {object} Data for Area chart\r\n */\r\nexport function createAreaChartData(dataset) {\r\n  const areaChartData = {};\r\n\r\n  Object.entries(dataset).forEach(([year, yearData]) => {\r\n    // Time data not available for years before 2019\r\n    if (parseInt(year) < 2019) {\r\n      return;\r\n    }\r\n\r\n    areaChartData[year] = {};\r\n    let averageTimeCounts;\r\n\r\n    // Sums counts across each day for each counter\r\n    // Also adds neighborhood\r\n    Object.entries(yearData).forEach(([counter, counterData]) => {\r\n      let newCounts = Object.values(\r\n        groupSum(counterData.counts, 'time', 'count'),\r\n      );\r\n\r\n      // Save this counter's data to averageTimeCounts\r\n      if (!averageTimeCounts) {\r\n        averageTimeCounts = newCounts;\r\n      } else {\r\n        newCounts.map((count, i) => {\r\n          averageTimeCounts[i] += count;\r\n        });\r\n      }\r\n\r\n      areaChartData[year][counter] = {\r\n        name: counter,\r\n        counts: newCounts.map((v, i) => {\r\n          return {\r\n            index: i,\r\n            value: v,\r\n          };\r\n        }),\r\n      };\r\n    });\r\n\r\n    const totalCounters = Object.keys(yearData).length;\r\n\r\n    areaChartData[year]['Average'] = {\r\n      name: 'All',\r\n      counts: averageTimeCounts.map((counts, i) => {\r\n        return { index: i, value: Math.round(counts / totalCounters) };\r\n      }),\r\n    };\r\n  });\r\n\r\n  return areaChartData;\r\n}\r\n\r\n/** Generates data in format for bar chart\r\n *\r\n * @param {object} dataset Dataset created by createDataset\r\n */\r\nexport function createBarChartData(dataset) {\r\n  const barChartData = {};\r\n\r\n  Object.entries(dataset).forEach(([year, yearData]) => {\r\n    let allCounts = 0;\r\n\r\n    // Sums counts across entire year for each counter\r\n    Object.entries(yearData).forEach(([counter, counterData]) => {\r\n      const counterSum = {\r\n        year: year,\r\n        counts: sum(counterData.counts, 'count'),\r\n      };\r\n\r\n      allCounts += counterSum.counts;\r\n\r\n      barChartData[counter]\r\n        ? barChartData[counter].push(counterSum)\r\n        : (barChartData[counter] = [counterSum]);\r\n    });\r\n\r\n    // Adds average of all sensors for year for default view\r\n    const average = {\r\n      year: year,\r\n      counts: Math.round(allCounts / Object.keys(yearData).length),\r\n    };\r\n\r\n    barChartData['Average']\r\n      ? barChartData['Average'].push(average)\r\n      : (barChartData['Average'] = [average]);\r\n  });\r\n\r\n  return barChartData;\r\n}\r\n","/**\r\n * Adds SVG groups for the map base, bike paths and circles\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n */\r\nexport function generateMapGroups(width, height) {\r\n  d3.select('#map-svg')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .append('g')\r\n    .attr('id', 'map-base-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .select(function () {\r\n      return this.parentNode;\r\n    })\r\n    .append('g')\r\n    .attr('id', 'map-lanes-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .select(function () {\r\n      return this.parentNode;\r\n    })\r\n    .append('g')\r\n    .attr('id', 'map-circles-g')\r\n    .attr('width', width)\r\n    .attr('height', height);\r\n}\r\n\r\n/**\r\n * Draws the map base of Montreal.\r\n *\r\n * @param {object[]} data The data for the map base\r\n * @param {*} path The path associated with the current projection\r\n */\r\nexport function drawMapBackground(data, path) {\r\n  d3.select('#map-base-g')\r\n    .selectAll('path')\r\n    .data(data)\r\n    .enter()\r\n    .append('path')\r\n    .attr('d', path)\r\n    .attr('fill', '#d8dbe3')\r\n    .attr('stroke', '#ffffff')\r\n    .attr('stroke-width', 1);\r\n}\r\n\r\n/**\r\n * Draws the cycle lanes of Montreal\r\n *\r\n * @param {object[]} data The data for the cycle lanes\r\n * @param {*} path The path associated with the current projection\r\n */\r\nexport function drawBikePaths(data, path) {\r\n  d3.select('#map-lanes-g')\r\n    .selectAll('path')\r\n    .data(data)\r\n    .enter()\r\n    .append('path')\r\n    .attr('d', path)\r\n    .attr('fill', 'rgba(0,0,0,0)')\r\n    .attr('stroke', '#0bb52d')\r\n    .attr('stroke-width', 1.5);\r\n}\r\n\r\nfunction radiusScale(data) {\r\n  const maxCounts = d3.max(data.map((data) => data.counts));\r\n  return d3.scaleLinear().domain([0, maxCounts]).range([4, 10]);\r\n}\r\n\r\n/**\r\n * Draws the counter\r\n *\r\n * @param {object[]} data The data for the map\r\n * @param callback The callback to call on circle click\r\n */\r\nexport function drawCircles(data, callback) {\r\n  const scale = radiusScale(data);\r\n\r\n  d3.select('#map-circles-g').selectAll('circle').remove();\r\n\r\n  d3.select('#map-circles-g')\r\n    .selectAll('circle')\r\n    .data(data)\r\n    .enter()\r\n    .append('circle')\r\n    .attr('class', 'circle')\r\n    .attr('r', (d) => scale(d.counts))\r\n    .attr('cx', (d) => d.x)\r\n    .attr('cy', (d) => d.y)\r\n    .attr('fill', '#0461cc')\r\n    .attr('stroke', '#ffffff')\r\n    .attr('stroke-width', 1)\r\n    .on('click', callback);\r\n}\r\n","/**\r\n * Draws the dropdown menu to select the desired year\r\n *\r\n * @param {number} years The years to display\r\n * @param {number} width The width of the graph, used to place the button\r\n *\r\n * @returns Initial year in dropdown\r\n */\r\nexport function drawDropdown(years, width) {\r\n  d3.select('#dropdown')\r\n    .attr('transform', 'translate(' + width + ', 140)')\r\n    .attr('width', 130)\r\n    .attr('height', 25)\r\n    .selectAll('myOptions')\r\n    .data(years)\r\n    .enter()\r\n    .append('option')\r\n    .text(function (d) {\r\n      return d;\r\n    })\r\n    .attr('value', function (d) {\r\n      return d;\r\n    });\r\n\r\n  return years[0];\r\n}\r\n","/** Appends a callback to redraw graphs to the year dropdown\r\n *\r\n * @param callback Redraw function to call on click\r\n */\r\nexport function dropDownClickHandler(callback) {\r\n  d3.select('#dropdown').on('change', () => {\r\n    const year = d3.select('#dropdown').property('value');\r\n    console.log(year);\r\n    callback(year);\r\n    // Pass year to drawBarChart, drawMapCircles and drawAreaChart to redraw\r\n    // Rerun drawLineChart with no name specified (default data)\r\n  });\r\n}\r\n\r\n/** To be passed to circles to redraw charts on circle click\r\n *\r\n * @param callback Callback to call on click\r\n */\r\nexport function circleClickHandler(callback) {\r\n  return (d) => {\r\n    const year = d3.select('#dropdown').property('value');\r\n    const name = d.name;\r\n    console.log(name);\r\n    callback(year, name);\r\n    // Pass d.name, d.neighborhood and lineChartData[year][name] to drawLinechart\r\n  };\r\n}\r\n","function generateXScale(width, days) {\r\n  return d3.scaleLinear().domain([0, days]).range([0, width]);\r\n}\r\n\r\nfunction generateXTimescale(width) {\r\n  return d3\r\n    .scaleTime()\r\n    .domain([new Date(2019, 12, 15, 0, 0), new Date(2020, 11, 1, 0, 0)])\r\n    .range([0, width])\r\n    .nice();\r\n}\r\n\r\nfunction generateYScale(height, counts) {\r\n  return d3\r\n    .scaleLinear()\r\n    .domain([0, d3.max(counts)])\r\n    .range([height, 0]);\r\n}\r\n\r\nfunction addLabels(g, width, height, name, neighborhood) {\r\n  // X label\r\n  g.append('text')\r\n    .text(\"Jours de l'année\")\r\n    .attr('x', width / 3)\r\n    .attr('y', height + 30);\r\n  // Y label\r\n  g.append('text')\r\n    .text('Comptes')\r\n    .attr('x', 10)\r\n    .attr('y', height / 2)\r\n    .attr('transform', 'rotate(-90)');\r\n  // Title\r\n  if (name) {\r\n    g.append('text')\r\n      .text(name + ' - ' + neighborhood)\r\n      .attr('x', width / 4)\r\n      .attr('y', 10);\r\n  } else {\r\n    g.append('text')\r\n      .text('Moyenne de tous les compteurs')\r\n      .attr('x', width / 4)\r\n      .attr('y', 10);\r\n  }\r\n}\r\n\r\nfunction addAxes(g, width, height, yScale) {\r\n  // Add axes, including special time axis on X\r\n  g.append('g')\r\n    .attr('transform', 'translate(0,' + height + ')')\r\n    .call(d3.axisBottom(generateXTimescale(width)).ticks(6));\r\n  g.append('g').call(d3.axisLeft(yScale));\r\n}\r\n\r\n/**\r\n * Draws the line chart\r\n *\r\n * @param {object[]} data The data for the map\r\n * @param callback The callback to call on circle click\r\n */\r\nexport function drawLineChart(width, height, averageData, counterData) {\r\n  // Reset line chart svg\r\n  d3.select('#line-g').remove();\r\n\r\n  const group = d3\r\n    .select('#map-svg')\r\n    .append('g')\r\n    .attr('id', 'line-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .attr('transform', 'translate(40, 0)');\r\n\r\n  // Generate scales\r\n  const xScale = generateXScale(width, averageData.counts.length);\r\n  const yScale = generateYScale(height, [\r\n    ...averageData.counts.map((v) => v.value),\r\n    ...(counterData ? counterData.counts.map((v) => v.value) : []),\r\n  ]);\r\n\r\n  addAxes(group, width, height, yScale);\r\n  addLabels(\r\n    group,\r\n    width,\r\n    height,\r\n    counterData && counterData.name,\r\n    counterData && counterData.neighborhood,\r\n  );\r\n\r\n  group\r\n    .append('path')\r\n    .datum(averageData.counts)\r\n    .attr('fill', 'rgba(0, 0, 0, 0)')\r\n    .attr('stroke', '#9a9a9a')\r\n    .attr('stroke-width', 1.5)\r\n    .attr(\r\n      'd',\r\n      d3\r\n        .line()\r\n        .x(function (d) {\r\n          return xScale(d.index);\r\n        })\r\n        .y(function (d) {\r\n          return yScale(d.value);\r\n        }),\r\n    );\r\n\r\n  if (counterData) {\r\n    group\r\n      .append('path')\r\n      .datum(counterData.counts)\r\n      .attr('fill', 'rgba(0, 0, 0, 0)')\r\n      .attr('stroke', 'rgba(18, 81, 153, 1)')\r\n      .attr('stroke-width', 1.5)\r\n      .attr(\r\n        'd',\r\n        d3\r\n          .line()\r\n          .x(function (d) {\r\n            return xScale(d.index);\r\n          })\r\n          .y(function (d) {\r\n            return yScale(d.value);\r\n          }),\r\n      );\r\n  }\r\n}\r\n","function generateXScale(width) {\r\n  return d3.scaleLinear().domain([0, 96]).range([0, width]);\r\n}\r\n\r\nfunction generateXTimescale(width) {\r\n  return d3\r\n    .scaleTime()\r\n    .domain([new Date(2020, 1, 1, 0, 0), new Date(2020, 1, 2, 0, 0)])\r\n    .range([0, width])\r\n    .nice();\r\n}\r\n\r\nfunction generateYScale(height, counts) {\r\n  return d3\r\n    .scaleLinear()\r\n    .domain([0, d3.max(counts)])\r\n    .range([height, 0]);\r\n}\r\n\r\nfunction addLabels(g, width, height, name, neighborhood) {\r\n  // X label\r\n  g.append('text')\r\n    .text(\"Heures de la journée\")\r\n    .attr('x', width / 3)\r\n    .attr('y', height + 20);\r\n  // Y label\r\n  g.append('text')\r\n    .text('Comptes')\r\n    .attr('x', 10)\r\n    .attr('y', height / 2)\r\n    .attr('transform', 'rotate(-90)');\r\n  // Title\r\n  if (name) {\r\n    g.append('text')\r\n      .text(name + ' - ' + neighborhood)\r\n      .attr('x', width / 3)\r\n      .attr('y', 10);\r\n  } else {\r\n    g.append('text')\r\n      .text('Moyenne de tous les compteurs')\r\n      .attr('x', width / 3)\r\n      .attr('y', 10);\r\n  }\r\n}\r\n\r\n/**\r\n * Draws the area chart\r\n *\r\n * @param {object[]} data The data for the map\r\n * @param callback The callback to call on circle click\r\n */\r\nexport function drawAreaChart(width, height, averageData, counterData) {\r\n  // Reset area chart svg\r\n  d3.select('#area-g').remove();\r\n\r\n  const group = d3\r\n    .select('#area-svg')\r\n    .attr('width', width + 40)\r\n    .attr('height', height + 20)\r\n    .append('g')\r\n    .attr('id', 'area-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n    .attr('transform', 'translate(40, 0)');\r\n\r\n  // Generate scales\r\n  const xScale = generateXScale(width);\r\n  const yScale = generateYScale(height, [\r\n    ...averageData.counts.map((v) => v.value),\r\n    ...(counterData ? counterData.counts.map((v) => v.value) : []),\r\n  ]);\r\n\r\n  // Add axes, including special time axis on X\r\n  group\r\n    .append('g')\r\n    .attr('transform', 'translate(0,' + height + ')')\r\n    .call(d3.axisBottom(generateXTimescale(width)));\r\n  group.append('g').call(d3.axisLeft(yScale));\r\n\r\n  // Add labels\r\n  addLabels(\r\n    group,\r\n    width,\r\n    height,\r\n    counterData && counterData.name,\r\n    counterData && counterData.neighborhood,\r\n  );\r\n  group\r\n    .append('path')\r\n    .datum(averageData.counts)\r\n    .attr('fill', '#c9c9c9')\r\n    .attr('stroke', '#9a9a9a')\r\n    .attr('stroke-width', 1.5)\r\n    .attr(\r\n      'd',\r\n      d3\r\n        .area()\r\n        .x(function (d) {\r\n          return xScale(d.index);\r\n        })\r\n        .y0(height)\r\n        .y1(function (d) {\r\n          return yScale(d.value);\r\n        }),\r\n    );\r\n\r\n  if (counterData) {\r\n    group\r\n      .append('path')\r\n      .datum(counterData.counts)\r\n      .attr('fill', 'rgba(77, 149, 232, 0.5)')\r\n      .attr('stroke', 'rgba(18, 81, 153, 0.5)')\r\n      .attr('stroke-width', 1.5)\r\n      .attr(\r\n        'd',\r\n        d3\r\n          .area()\r\n          .x(function (d) {\r\n            return xScale(d.index);\r\n          })\r\n          .y0(height)\r\n          .y1(function (d) {\r\n            return yScale(d.value);\r\n          }),\r\n      );\r\n  }\r\n}\r\n","/**\r\n * Appends SVG g elements which will contain the x and y axes.\r\n *\r\n * @param {*} g The d3 Selection of the graph's g SVG element\r\n */\r\n export function appendAxes (g) {\r\n    g.append('g')\r\n      .attr('class', 'x axis')\r\n  \r\n    g.append('g')\r\n      .attr('class', 'y axis')\r\n  }\r\n  \r\n/**\r\n * Appends the labels for the the y axis and the title of the graph.\r\n *\r\n * @param {*} g The d3 Selection of the graph's g SVG element\r\n */\r\n export function appendGraphLabels (g) {\r\n    g.append('text')\r\n      .text('Total counts for the year')\r\n      .attr('class', 'y axis-text')\r\n      .attr('transform', 'rotate(-90)')\r\n      .attr('fill', '#898989')\r\n      .attr('font-size', 12)\r\n  \r\n    g.append('text')\r\n      .text('Average counts per year')\r\n      .attr('class', 'title')\r\n      .attr('fill', '#898989')\r\n  }\r\n\r\n/**\r\n * Sets the size of the SVG canvas containing the graph.\r\n *\r\n * @param {number} width The desired width\r\n * @param {number} height The desired height\r\n */\r\n export function setCanvasSize (width, height) {\r\n    d3.select('#bar-svg')\r\n      .attr('width', width)\r\n      .attr('height', height)\r\n  }\r\n\r\n/**\r\n * Positions the x axis label, y axis label and title label on the graph.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n */\r\n export function positionLabels (width, height) {\r\n    d3.select('.y.axis-text')\r\n      .attr('x', -50)\r\n      .attr('y', height / 2)\r\n  \r\n    d3.select('.title')\r\n      .attr('x', width / 2)\r\n      .attr('y', -35)\r\n  }\r\n\r\n/**\r\n * Updates the X scale to be used within each group of the grouped bar chart\r\n *\r\n * @param {*} scale The scale used for the subgroups\r\n * @param {string[]} subGroupBars The bars per subgroup (average on all counters and specific counter)\r\n * @param {*} xScale The graph's encompassing x scale\r\n */\r\n export function updateXSubgroupScale (scale, subGroupBars, xScale) {\r\n    scale\r\n      .domain(subGroupBars)\r\n      .range([0, xScale.bandwidth()])\r\n  }\r\n\r\n/**\r\n * Draws the x axis at the bottom of the plot.\r\n *\r\n * @param {*} xScale The scale to use for the x axis\r\n * @param {number} height The height of the graph\r\n */\r\nexport function drawXAxis (xScale, height) {\r\n    d3.select('.x.axis')\r\n      .attr('transform', 'translate(0, ' + height + ')')\r\n      .call(d3.axisBottom(xScale)\r\n        .tickFormat(x => `year ${x}`))\r\n  }\r\n\r\n/**\r\n * Draws the y axis at the left of the plot.\r\n *\r\n * @param {*} yScale The scale to use for the y axis\r\n */\r\nexport function drawYAxis (yScale) {\r\n    d3.select('.y.axis').call(d3.axisLeft(yScale).ticks(5))\r\n  }\r\n\r\n/**\r\n * Sets the domain and range of the X scale.\r\n *\r\n * @param {*} scale The x scale\r\n * @param {object[]} data The data to be used\r\n * @param {number} width The width of the graph\r\n */\r\n export function updateGroupXScale (scale, data, width) {\r\n    scale.domain(data.Average.year).range([0, width])\r\n  }\r\n  \r\n  /**\r\n   * Sets the domain and range of the Y scale.\r\n   *\r\n   * @param {*} scale The Y scale\r\n   * @param {object[]} data The data to be used\r\n   * @param {number} height The height of the graph\r\n   */\r\n  export function updateYScale (scale, data, height) {\r\n    const max = d3.max(data.Average.counts, m => d3.max(m))\r\n    scale.domain([0, max]).range([height, 0])\r\n  }\r\n  \r\n  /**\r\n   * Creates the groups for the grouped bar chart and appends them to the graph.\r\n   * Each group corresponds to a pair of average/chosen counter values\r\n   *\r\n   * @param {object[]} data The data to be used\r\n   * @param {*} x The graph's x scale\r\n   */\r\n  export function createGroups (data, x) {\r\n    d3.select('#bar-svg')\r\n      .selectAll('.group')\r\n      .data(data)\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'group')\r\n      .attr('transform', data => 'translate(' + x(data.Average.year + ',0)'))\r\n      .attr('x', (data) => x(data.Average.year))\r\n  }\r\n  /**\r\n   * Draws the bars inside the groups\r\n   *\r\n   * @param {*} y The graph's y scale\r\n   * @param {*} xSubgroup The x scale to use to position the rectangles in the groups\r\n   * @param {number} height The height of the graph\r\n   * @param {object[]} data The data to be used\r\n   */\r\n  export function drawBars (y, xSubgroup, height, data) {\r\n    d3.select('#bar-svg')\r\n      .selectAll('.group')\r\n      .selectAll('rect')\r\n      .data(data)\r\n      .enter()\r\n      .append('rect')\r\n      .attr('x', (data) => xSubgroup(data.Average.year))\r\n      .attr('y', (data) => y(data.Average.counts))\r\n      .attr('width', xSubgroup.bandwidth())\r\n      .attr('height', (data) => height - y(data.Average.counts))\r\n  }\r\n\r\nconst margin = { top: 80, right: 0, bottom: 80, left: 55 }\r\n\r\nlet bounds\r\nlet svgSize\r\nlet graphSize\r\n\r\nconst xScale = d3.scaleBand().padding(0.15)\r\nconst xSubgroupScale = d3.scaleBand().padding([0.015])\r\nconst yScale = d3.scaleLinear()\r\n\r\n/**\r\n     *   This function handles the graph's sizing.\r\n     */\r\n function setSizing () {\r\n    bounds = d3.select('#bar-svg').node().getBoundingClientRect()\r\n\r\n    svgSize = {\r\n      width: bounds.width,\r\n      height: 550\r\n    }\r\n\r\n    graphSize = {\r\n      width: svgSize.width - margin.right - margin.left,\r\n      height: svgSize.height - margin.bottom - margin.top\r\n    }\r\n\r\n    setCanvasSize(svgSize.width, svgSize.height)\r\n  }\r\n\r\n/**\r\n     *   This function builds the graph.\r\n     */\r\n export function buildBarChart (data, g) {\r\n    appendAxes(g)\r\n    appendGraphLabels(g)\r\n    setSizing()\r\n\r\n    var subGroupBars = ['Average', 'X'] // Update according to data input\r\n\r\n    positionLabels(graphSize.width, graphSize.height)\r\n\r\n    updateGroupXScale(xScale, data, graphSize.width)\r\n    updateXSubgroupScale(xSubgroupScale, subGroupBars, xScale)\r\n    updateYScale(yScale, data, graphSize.height)\r\n\r\n    drawXAxis(xScale, graphSize.height)\r\n    drawYAxis(yScale)\r\n\r\n    createGroups(data, xScale)\r\n    drawBars(yScale, xSubgroupScale, subGroupBars, graphSize.height)\r\n  }","import 'regenerator-runtime/runtime.js';\r\nimport {\r\n  createBarChartData,\r\n  createLineChartData,\r\n  createDataset,\r\n  getLocationData,\r\n  getCounterData,\r\n  group,\r\n  createAreaChartData,\r\n  createMapData,\r\n} from './scripts/preprocess';\r\nimport {\r\n  generateMapGroups,\r\n  drawMapBackground,\r\n  drawBikePaths,\r\n  drawCircles,\r\n} from './scripts/mapViz';\r\nimport { drawDropdown } from './scripts/yearButton.js';\r\nimport {\r\n  dropDownClickHandler,\r\n  circleClickHandler,\r\n} from './scripts/clickHandlers';\r\nimport {\r\n  getMontrealData,\r\n  getProjection,\r\n  getPath,\r\n  getBikePaths,\r\n} from './scripts/geography';\r\nimport { drawLineChart } from './scripts/lineChart';\r\nimport { drawAreaChart } from './scripts/areaChart';\r\nimport { buildBarChart } from './scripts/barChartViz.js';\r\n\r\n(async function (d3) {\r\n  const mapsize = {\r\n    width: 800,\r\n    height: 625,\r\n  };\r\n  const areaSize = {\r\n    width: 800,\r\n    height: 350,\r\n  };\r\n  const lineSize = {\r\n    width: 400,\r\n    height: 250,\r\n  };\r\n\r\n  // Get all raw data\r\n  const years = [\r\n    // 2009, 2010,\r\n    // 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020,\r\n    2019,\r\n  ];\r\n  const montreal = await getMontrealData();\r\n  const bikePaths = await getBikePaths();\r\n  const locationData = await getLocationData();\r\n  const counterData = await getCounterData(years);\r\n\r\n  // Generate SVG groups\r\n  generateMapGroups(mapsize.width, mapsize.height);\r\n\r\n  // Render map\r\n  const projection = getProjection();\r\n  const path = getPath(projection);\r\n  drawMapBackground(montreal, path);\r\n  drawBikePaths(bikePaths, path);\r\n\r\n  // Get all processed data\r\n  const dataset = createDataset(locationData, counterData, years);\r\n  const mapData = createMapData(dataset, montreal, projection);\r\n  const lineChartData = createLineChartData(dataset, montreal);\r\n  const areaChartData = createAreaChartData(dataset);\r\n  const barChartData = createBarChartData(dataset);\r\n\r\n  // Interactivity and re-drawing\r\n  function redrawVizForCounter(year, counter) {\r\n    // Add barchart, areachart and linechart here\r\n    // Called on counter click\r\n    drawAreaChart(\r\n      areaSize.width,\r\n      areaSize.height,\r\n      areaChartData[year]['Average'],\r\n      areaChartData[year][counter],\r\n    );\r\n    drawLineChart(\r\n      lineSize.width,\r\n      lineSize.height,\r\n      lineChartData[year]['Average'],\r\n      lineChartData[year][counter],\r\n    );\r\n    // buildBarChart(barChartData, '#bar-svg'); WITH COUNTER\r\n  }\r\n  function redrawVizForYear(year) {\r\n    drawCircles(mapData[year], circleClickHandler(redrawVizForCounter));\r\n    drawAreaChart(\r\n      areaSize.width,\r\n      areaSize.height,\r\n      areaChartData[year]['Average'],\r\n    );\r\n    drawLineChart(\r\n      lineSize.width,\r\n      lineSize.height,\r\n      lineChartData[year]['Average'],\r\n    );\r\n    // buildBarChart(barChartData, '#bar-svg'); WITH NO COUNTER\r\n  }\r\n\r\n  const year = drawDropdown(years, mapsize.width);\r\n  dropDownClickHandler(redrawVizForYear);\r\n\r\n  // Call draw graphs\r\n  redrawVizForYear(year);\r\n})(d3);\r\n"]}